# Funnel Saver

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö –≤–æ—Ä–æ–Ω–æ–∫ (funnels).

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–∞–º
- üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç—ã –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
- üìù HTML —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- üîç –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤ Markdown
- üìä JSON –æ—Ç—á—ë—Ç—ã —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- üéØ –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- üö´ –ò–∑–±–µ–≥–∞–Ω–∏–µ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (privacy, terms, back, help)
- üåê –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ–º–µ–Ω–∞ (–Ω–µ —É—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Å–∞–π—Ç—ã)
- üì± –≠–º—É–ª—è—Ü–∏—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (iPhone 16 Pro Max)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
funnelsaver/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ browser.py         # Playwright wrapper
‚îÇ   ‚îú‚îÄ‚îÄ clicker.py         # –õ–æ–≥–∏–∫–∞ –∫–ª–∏–∫–æ–≤ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ scraper.py         # –°–∫—Ä–∏–Ω—à–æ—Ç—ã –∏ HTML
‚îÇ   ‚îú‚îÄ‚îÄ reporter.py        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ main.py            # CLI —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ outputs/               # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—É—Å–∫–æ–≤ (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è git)
‚îú‚îÄ‚îÄ requirements.txt       # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ setup_venv.sh         # –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω–∏—è venv
‚îî‚îÄ‚îÄ README.md             # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
./setup_venv.sh
```

–∏–ª–∏ –≤—Ä—É—á–Ω—É—é:

```bash
python3.13 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
playwright install chromium
```

### 2. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
source .venv/bin/activate
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
python -m src.main --url "https://example.com" --max-steps 10
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

- `--url` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - —Å—Ç–∞—Ä—Ç–æ–≤—ã–π URL –≤–æ—Ä–æ–Ω–∫–∏
- `--max-steps` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20) - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤
- `--config` - –ø—É—Ç—å –∫ YAML –∫–æ–Ω—Ñ–∏–≥—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `--headless` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é true) - headless —Ä–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞
- `--interactive` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false) - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º

### –ü—Ä–∏–º–µ—Ä—ã

```bash
# –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫
python -m src.main --url "https://appnebula.co/moon-compatibility/prelanding" --max-steps 5

# –° –∫–æ–Ω—Ñ–∏–≥–æ–º
python -m src.main --url "https://example.com" --config .funnelsaver.yml

# Visible browser mode
python -m src.main --url "https://example.com" --headless false
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ output

–ö–∞–∂–¥—ã–π –∑–∞–ø—É—Å–∫ —Å–æ–∑–¥–∞—ë—Ç –ø–∞–ø–∫—É:

```
outputs/{domain}_{timestamp}/
‚îú‚îÄ‚îÄ README.md                        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–ø—É—Å–∫–µ
‚îú‚îÄ‚îÄ funnel_report.md                 # –°–≤–æ–¥–Ω—ã–π –æ—Ç—á—ë—Ç
‚îú‚îÄ‚îÄ funnel_data.json                 # –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ step_0.md                        # –û—Ç—á—ë—Ç –ø–æ —à–∞–≥—É 0
‚îú‚îÄ‚îÄ step_0_{timestamp}.png           # –°–∫—Ä–∏–Ω—à–æ—Ç —à–∞–≥–∞ 0
‚îú‚îÄ‚îÄ step_0_{timestamp}.html          # HTML —à–∞–≥–∞ 0
‚îî‚îÄ‚îÄ ...
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.funnelsaver.yml`:

```yaml
viewport:
  width: 430
  height: 932

user_agent: "Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X)"

max_steps: 20

default_form_values:
  name: "Test User"
  email: "test@example.com"
```

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- –ó–∞–ø—É—Å–∫–∞–µ—Ç headless –±—Ä–∞—É–∑–µ—Ä (Chromium)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç viewport –∏ user-agent
- –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç–∞—Ä—Ç–æ–≤—ã–π URL

### 2. Step 0
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç cookies
- –î–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç HTML –∏ Markdown

### 3. Steps 1-N
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞:
1. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç cookies (–µ—Å–ª–∏ –ø–æ—è–≤–∏–ª–∏—Å—å)
2. –ò—â–µ—Ç –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∫–Ω–æ–ø–∫–∞–º –Ω–∞–¥ —Å—Å—ã–ª–∫–∞–º–∏
   - –ò—Å–∫–ª—é—á–∞–µ—Ç: back, help, privacy, terms, logo
   - –¢–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —Ç–µ–∫—É—â–µ–≥–æ –¥–æ–º–µ–Ω–∞
   - –¢–æ–ª—å–∫–æ –Ω–µ –ø–æ—Å–µ—â—ë–Ω–Ω—ã–µ URL
3. –ö–ª–∏–∫–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
4. –î–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç HTML
5. –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —à–∞–≥ –≤ –æ—Ç—á—ë—Ç—ã

### 4. –û—Å—Ç–∞–Ω–æ–≤–∫–∞
- –î–æ—Å—Ç–∏–≥–Ω—É—Ç max_steps
- –ù–µ—Ç –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –û—à–∏–±–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

## –≠–≤—Ä–∏—Å—Ç–∏–∫–∏

### –°–µ–ª–µ–∫—Ç–æ—Ä—ã –∫–Ω–æ–ø–æ–∫
- `<button>`
- `[role='button']`
- `[data-testid*='button']`
- `<input type="submit/button">`
- `<div onclick>`

### –ò—Å–∫–ª—é—á–µ–Ω–∏—è
–ù–µ –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º:
- back, previous, prev, –Ω–∞–∑–∞–¥
- help, support, –ø–æ–º–æ—â—å, –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- logo, home, –≥–ª–∞–≤–Ω–∞—è, –ª–æ–≥–æ—Ç–∏–ø
- privacy, terms, cookie, policy

### –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ–º–µ–Ω–∞
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –¥–æ–º–µ–Ω –ø–æ—Å–ª–µ redirect
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—ã –Ω–∞ –¥—Ä—É–≥–∏–µ –¥–æ–º–µ–Ω—ã
- –†–∞–∑—Ä–µ—à–∞–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞

- `browser.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Playwright
- `clicker.py` - –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –∏ –∫–ª–∏–∫–æ–≤
- `scraper.py` - —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∏ HTML
- `reporter.py` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤
- `config.py` - —á—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `main.py` - CLI –∏ –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤

–†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `BUTTON_SELECTORS` –≤ `clicker.py`:

```python
BUTTON_SELECTORS = [
    "button",
    "[role='button']",
    # –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π —Å–µ–ª–µ–∫—Ç–æ—Ä
    ".my-custom-button-class",
]
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

–†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `EXCLUDE_PATTERNS` –≤ `clicker.py`:

```python
EXCLUDE_PATTERNS = [
    "back", "previous",
    # –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω
    "cancel", "close",
]
```

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–§–æ—Ä–º—ã** - –ø–æ–∫–∞ –Ω–µ –∑–∞–ø–æ–ª–Ω—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ input –ø–æ–ª—è
2. **JavaScript** - –∂–¥—ë—Ç 1-2 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞
3. **–ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞** - –º–æ–∂–µ—Ç –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å overlay –∫–Ω–æ–ø–∫–∏
4. **CAPTCHA** - –Ω–µ –æ–±—Ö–æ–¥–∏—Ç –∫–∞–ø—á—É

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## –ê–≤—Ç–æ—Ä—ã

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é Claude Code
